<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data:; media-src 'self';">
  <title>Control — Carlos Tarrats</title>
  <meta name="description" content="Control: A text-only open-source on-device LLM app for iOS">

  <!-- Canonical -->
  <link rel="canonical" href="https://carlostarrats.github.io/projects/control.html">

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="../favicon.svg?v=2">

  <!-- Open Graph -->
  <meta property="og:type" content="article">
  <meta property="og:title" content="Control — Carlos Tarrats">
  <meta property="og:description" content="Control: A text-only open-source on-device LLM app for iOS">
  <meta property="og:url" content="https://carlostarrats.github.io/projects/control.html">
  <meta property="og:image" content="https://carlostarrats.github.io/images/social.jpg?v=3">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Control — Carlos Tarrats">
  <meta name="twitter:description" content="Control: A text-only open-source on-device LLM app for iOS">
  <meta name="twitter:image" content="https://carlostarrats.github.io/images/social.jpg?v=3">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Baskervville&family=Instrument+Serif:ital@0;1&display=swap" rel="stylesheet">

  <script>
    (function(){var t=sessionStorage.getItem('siteTheme');if(t&&t!=='default')document.documentElement.setAttribute('data-theme',t);})();
  </script>
  <link rel="stylesheet" href="../styles.css">
</head>
<body>
  <div class="top-bar">
    <div class="top-bar__clock" id="top-bar-clock"></div>
    <div class="top-bar__colors">
      <button class="top-bar__swatch top-bar__swatch--default active" data-theme="default" aria-label="Default dark theme"></button>
      <button class="top-bar__swatch" data-theme="peach" aria-label="Peach theme"></button>
      <button class="top-bar__swatch" data-theme="pink" aria-label="Pink theme"></button>
      <button class="top-bar__swatch" data-theme="mint" aria-label="Mint theme"></button>
      <button class="top-bar__swatch" data-theme="yellow" aria-label="Yellow theme"></button>
      <button class="top-bar__swatch" data-theme="lavender" aria-label="Lavender theme"></button>
    </div>
  </div>
  <script>
    (function() {
      var clockEl = document.getElementById('top-bar-clock');
      function updateClock() {
        var now = new Date();
        var time = now.toLocaleString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
        var day = now.toLocaleString('en-US', { weekday: 'long' });
        clockEl.textContent = time + ', ' + day;
      }
      updateClock();
      setInterval(updateClock, 1000);

      var swatches = document.querySelectorAll('.top-bar__swatch');
      var saved = sessionStorage.getItem('siteTheme') || 'default';
      swatches.forEach(function(s) {
        if (s.getAttribute('data-theme') === saved) {
          s.classList.add('active');
        } else {
          s.classList.remove('active');
        }
        s.addEventListener('click', function() {
          var theme = this.getAttribute('data-theme');
          swatches.forEach(function(el) { el.classList.remove('active'); });
          this.classList.add('active');
          if (theme === 'default') {
            document.documentElement.removeAttribute('data-theme');
            sessionStorage.removeItem('siteTheme');
          } else {
            document.documentElement.setAttribute('data-theme', theme);
            sessionStorage.setItem('siteTheme', theme);
          }
        });
      });
    })();
  </script>

  <!-- Preloader -->
  <div class="preloader" id="preloader">
    <div class="preloader__spinner"></div>
  </div>
  <script>
    (function() {
      var preloader = document.getElementById('preloader');
      if (sessionStorage.getItem('fontsLoaded')) {
        preloader.style.display = 'none';
      } else {
        var fontsReady = false;
        var minTimeReady = false;
        var loaded = false;
        function tryHide() {
          if (loaded || !fontsReady || !minTimeReady) return;
          loaded = true;
          sessionStorage.setItem('fontsLoaded', 'true');
          preloader.classList.add('is-hidden');
          setTimeout(function() {
            preloader.style.display = 'none';
          }, 400);
        }
        // Minimum 2s display time
        setTimeout(function() {
          minTimeReady = true;
          tryHide();
        }, 2000);
        // Hide when fonts ready AND min time elapsed
        function onFontsReady() {
          fontsReady = true;
          tryHide();
        }
        document.fonts.ready.then(onFontsReady);
        setTimeout(onFontsReady, 4000);
      }
    })();
  </script>

  <a href="#main-content" class="skip-link">Skip to main content</a>
  <div class="detail-page detail-page--control">
    <nav class="detail-nav">
      <a href="../index.html" class="back-link" aria-label="Back to homepage">Back</a>
      <a href="https://apps.apple.com/us/app/control-llm-interface/id6752229004" class="external-link" target="_blank" rel="noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="2" y1="12" x2="22" y2="12"></line>
          <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
        </svg>
        App Store
      </a>
    </nav>

    <article id="main-content" class="content-card">
      <header class="project-header">
        <div class="project-header__title">
          <span class="project-header__title-name project-header__title-name--control">Control </span><span class="project-header__title-dash">—</span> A text-only open-source on-device LLM app for iOS (Gemma3, Llama3.2, SmolLM2, Qwen3)
        </div>

        <div class="project-header__description">
          <p>I wanted an AI tool that kept everything local. Control runs open-source language models entirely on your device with no accounts, no data collection, and no network dependency. Your conversations stay on your phone and disappear each day.</p>
          <p>Upload PDFs for quick, on-device summaries without your documents ever leaving your phone. Customize colors and avatars to make it yours. Supports English, French, and Spanish. Built in Cursor.</p>
        </div>
      </header>

      <div class="view-toggle" role="tablist" aria-label="View mode">
        <button class="view-toggle__btn active" data-view="visual" role="tab" aria-selected="true" aria-controls="project-visual">Visual</button>
        <button class="view-toggle__btn" data-view="text" role="tab" aria-selected="false" aria-controls="project-text">Text</button>
      </div>

      <section class="project-images" id="project-visual" role="tabpanel">
        <img src="../images/control/control-hero.jpg" alt="Control app screenshots showing the logo, model selection, chat interface, and customization options" class="project-images__item">
        <div class="project-images__video">
          <video autoplay muted loop playsinline>
            <source src="../images/control/control-1.mp4" type="video/mp4">
          </video>
        </div>
        <div class="project-images__grid">
          <div class="project-images__video">
            <video autoplay muted loop playsinline>
              <source src="../images/control/control-2.mp4" type="video/mp4">
            </video>
          </div>
          <div class="project-images__video">
            <video autoplay muted loop playsinline>
              <source src="../images/control/control-3.mp4" type="video/mp4">
            </video>
          </div>
          <div class="project-images__video">
            <video autoplay muted loop playsinline>
              <source src="../images/control/control-4.mp4" type="video/mp4">
            </video>
          </div>
          <div class="project-images__video">
            <video autoplay muted loop playsinline>
              <source src="../images/control/control-5.mp4" type="video/mp4">
            </video>
          </div>
        </div>
      </section>

      <section class="project-text" id="project-text" role="tabpanel">
        <div class="project-text__section">
          <h3 class="project-text__heading">Problem</h3>
          <p class="project-text__body">I wanted to build an on-device AI app using open-source models, partly for privacy and partly to learn firsthand what small local models can and can't do. Most AI apps required accounts, sent data to servers, and offered no transparency about what happened with your conversations. There was no simple, free option that ran entirely on your phone with zero network dependency, no data collection, and no accounts. I also wanted to understand what building with these models actually felt like: what works, what breaks, and where the ceiling is when everything runs locally.</p>
        </div>
        <div class="project-text__section">
          <h3 class="project-text__heading">Process</h3>
          <p class="project-text__body">Started with much bigger ambitions: speech input, reactive avatar animations that responded to voice, and full PDF comprehension. Hitting the limitations of on-device models forced repeated pivots. Speech-to-text was too unreliable at small model sizes. PDF processing had to become a summary-based extraction using Vision and PDFKit rather than full document understanding, which sacrificed accuracy. The animated avatars required more processing overhead than the device could spare while running inference. The core inference layer itself needed an Objective-C++ bridge to llama.cpp with streaming token generation and manual memory management. Over 234 commits, the scope narrowed from an ambitious multimodal assistant into something focused and honest about what these models can actually do on a phone.</p>
        </div>
        <div class="project-text__section">
          <h3 class="project-text__heading">Solution</h3>
          <p class="project-text__body">A text-only iOS app that runs open-source LLMs entirely on-device using llama.cpp. Supports models from Google (Gemma 3), Meta (Llama 3.2), Hugging Face (SmolLM2), Alibaba (Qwen3), and Microsoft (Phi-3), all downloaded directly from Hugging Face and stored locally. The app is 8.9MB before model downloads. Conversations stay on your phone, reset within 24 hours, and are never transmitted anywhere. Features include PDF upload for on-device summaries, customizable colors and avatars, Metal shader visual effects, iOS Shortcuts integration for automation workflows, and support for English, French, and Spanish. Runs on iPhone, iPad, and Mac with Apple Silicon. Built natively in Swift with IBM Plex Mono throughout and a dark-only minimal interface. Free with no subscriptions, open-sourced under Apache 2.0.</p>
        </div>
        <div class="project-text__section">
          <h3 class="project-text__heading">Outcome</h3>
          <p class="project-text__body">Live on the App Store at version 1.3. The project gave me a grounded understanding of what small on-device models are capable of and where they fall short. Gemma 3 and Qwen3 handle conversational tasks well, but anything requiring deep reasoning or long context breaks down fast. The constraints shaped the product into something deliberately minimal: no server costs, no user data to protect, and a genuine privacy story that's verifiable because the full source code is public. Open-sourced on GitHub with 234 commits across the full build.</p>
        </div>
      </section>
    </article>

    <footer class="detail-footer">
      <p class="body">© 2026</p>
    </footer>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // View toggle with crossfade
      var toggleBtns = document.querySelectorAll('.view-toggle__btn');
      var detailPage = document.querySelector('.detail-page');
      var images = document.querySelector('.project-images');
      var textSection = document.querySelector('.project-text');
      var isAnimating = false;
      toggleBtns.forEach(function(btn) {
        btn.addEventListener('click', function() {
          if (this.classList.contains('active') || isAnimating) return;
          isAnimating = true;
          var goingToText = this.getAttribute('data-view') === 'text';
          var outgoing = goingToText ? images : textSection;
          var incoming = goingToText ? textSection : images;
          toggleBtns.forEach(function(b) {
            b.classList.remove('active');
            b.setAttribute('aria-selected', 'false');
          });
          this.classList.add('active');
          this.setAttribute('aria-selected', 'true');
          outgoing.style.opacity = '0';
          setTimeout(function() {
            if (goingToText) {
              detailPage.classList.add('is-text-mode');
            } else {
              detailPage.classList.remove('is-text-mode');
            }
            incoming.style.opacity = '0';
            void incoming.offsetHeight;
            incoming.style.opacity = '1';
            setTimeout(function() {
              outgoing.style.opacity = '';
              incoming.style.opacity = '';
              isAnimating = false;
            }, 200);
          }, 100);
        });
      });

      // Handle image loading
      document.querySelectorAll('.project-images__item').forEach(function(img) {
        if (img.complete) {
          img.classList.add('is-loaded');
        } else {
          img.addEventListener('load', function() {
            img.classList.add('is-loaded');
          });
        }
      });

      // Handle video loading
      document.querySelectorAll('.project-images__video').forEach(function(container) {
        var video = container.querySelector('video');
        if (video) {
          video.play().catch(function() {});
          if (video.readyState >= 3) {
            container.classList.add('is-loaded');
          } else {
            video.addEventListener('canplay', function() {
              container.classList.add('is-loaded');
            });
          }
        }
      });
    });
  </script>
</body>
</html>
